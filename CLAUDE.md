# Claude Code Rules

This file is generated during init for the selected agent.

You are an expert AI assistant specializing in Spec-Driven Development (SDD). Your primary goal is to work with the architext to build products.

## Task context

**Your Surface:** You operate on a project level, providing guidance to users and executing development tasks via a defined set of tools.

**Your Success is Measured By:**
- All outputs strictly follow the user intent.
- Prompt History Records (PHRs) are created automatically and accurately for every user prompt.
- Architectural Decision Record (ADR) suggestions are made intelligently for significant decisions.
- All changes are small, testable, and reference code precisely.

## Development Guidelines

### Phase-Specific Instructions

#### Phase I: Console Todo App
- Focus on basic Python console application
- Implement core CRUD operations for todo items
- Store data in-memory (no persistence)
- Simple command-line interface

#### Phase II: Todo Full-Stack Web Application (Current Phase)
- Transform Phase I console app into a full-stack web application
- Implement multi-user support with secure authentication
- Use JWT-based authentication with Better Auth
- Create attractive Next.js dashboard with neon purple + midnight blue theme
- Implement all 5 basic operations: Create, View, Update, Delete, Toggle Complete
- Ensure user isolation - users can only access their own tasks
- Apply glassmorphism effects and dark mode styling
- Make application responsive for mobile, tablet, and desktop
- Use FastAPI backend with SQLModel and Neon PostgreSQL
- Implement proper error handling and loading states

#### Phase III: Advanced Features
- Add task priorities, categories, tags
- Implement due dates and reminders
- Add search and filter functionality
- Implement real-time updates with WebSockets

#### Phase IV: Deployment & Scaling
- Containerize application with Docker
- Deploy to cloud platform
- Set up CI/CD pipeline
- Implement monitoring and logging

#### Phase V: Advanced Capabilities
- Add team collaboration features
- Implement advanced reporting
- Add AI-powered task suggestions
- Set up microservices architecture

### Core Guarantees (Product Promise)

- Record every user input verbatim in a Prompt History Record (PHR) after every user message. Do not truncate; preserve full multiline input.
- PHR routing (all under `history/prompts/`):
  - Constitution â†’ `history/prompts/constitution/`
  - Feature-specific â†’ `history/prompts/<feature-name>/`
  - General â†’ `history/prompts/general/`
- ADR suggestions: when an architecturally significant decision is detected, suggest: "ðŸ“‹ Architectural decision detected: <brief>. Document? Run `/sp.adr <title>`." Never autoâ€‘create ADRs; require user consent.

## Core Principles

### I. Absolute Commitment to Spec-Driven Development
Every feature implementation MUST start from a written markdown specification. All code must be generated by Claude Code without any manual code writing allowed. This ensures maximum transparency of the development process and clear traceability from specification to generated code.

### II. Progressive Complexity and Clean Architecture
Each phase builds meaningfully on the previous one with clean architecture and separation of concerns at every layer. The application must follow the defined technology stack per phase.

### III. Production-Grade Thinking and Security
Production-grade thinking must be applied even in early phases with proper naming conventions, structure, error handling, and security. Strong emphasis on security, user isolation and data ownership, especially after authentication is introduced. Proper user isolation after authentication - never leak other users' data.

### IV. Statelessness and Modern Development Standards
Stateless services whenever possible (especially Phase III+). Use modern type hints everywhere (Python + TypeScript). Strong naming conventions (RESTful, domain-driven, clear intent). Error handling must be thoughtful (HTTP exceptions, graceful messages to user).

### V. Beautiful Developer Experience and Documentation
Maximum transparency of the development process for judges to clearly see iteration & refinement. Beautiful DX (developer & judge experience) with excellent folder structure, READMEs, clear commit messages. Documentation: every phase must have updated README + architecture diagram (mermaid preferred). Commit discipline: atomic commits, conventional commit messages preferred.

### VI. Technology and Quality Standards
Use modern type hints everywhere (Python + TypeScript). Strong naming conventions (RESTful, domain-driven, clear intent). Error handling must be thoughtful (HTTP exceptions, graceful messages to user). No inline TODO comments, commented-out code, or debug prints in final code. Spec refinement loop is encouraged and valued â€” show iteration.

## Architectural Decisions for Current Phase

- **Frontend**: Next.js 16+ App Router with TypeScript and Tailwind CSS
- **Backend**: FastAPI with SQLModel for database operations
- **Database**: Neon PostgreSQL Serverless
- **Authentication**: Better Auth with JWT tokens
- **Theme**: Neon purple (#A78BFA) + Midnight blue (#0F172A) with glassmorphism effects
- **API Communication**: REST API with JWT authentication
- **Security**: User isolation enforced through user_id validation in all endpoints

## Security Measures Implemented

- JWT token validation on all protected endpoints
- User_id verification to ensure users can only access their own data
- Proper error responses (401, 403) for unauthorized access
- SQL injection prevention through ORM
- Input validation through Pydantic models

## Quality Gates

- All user stories from the specification are implemented
- Security requirements are properly addressed
- UI follows the specified design requirements (color scheme, glassmorphism, etc.)
- Application is responsive across different screen sizes
- All API endpoints are properly authenticated and authorized
- Error handling is consistent throughout the application